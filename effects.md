# План
 - Пример фронтенд кода https://gist.github.com/anonymous/7e58a756cfd32e27d9ade7fb32cf2f33 https://jsbin.com/bapofol/3/edit?html,js,output
 - Роль сайд-эффектов в приложении(их важность и повсеместность)
 - Проблемы которые несут сайд-ээфекты - уничтожение предсказуемости, сложно анализировать код, невозможность интерактивной разработки в изолированном окружении, плохая тестируемость, распространение сайд-эффектов по коду, плохая переиспользуемость(нельзя откинуть эффект)
 - Чтобы хотелось видеть? Эффекты становтся значениями и явно передаются вниз и вверх по иерархии. Их должно быть видно в сигнатуре. Они должны выполнятся не на месте создания везде по коду, а в едином месте(исполнителе)
 - Пробуем разобратся с DOM-эффектами при помощи реакта
  1)заменяем мутации дома на декларативное описание как должен изменится дом(JSX разметка на самом деле это POJO)
  2)Реакт рендерер решает как должен дом и применяет изменения(Это происходит в одном месте в коде)
L
 - Что нужно чтоб это реализовать
  1) придумать описание эффектов в виде значения(примеры)
  2) единый поток куда мы будем складывать эти значения
  3) исполнитель который будет выполнять все эффекты по их описаниям, и складывать результат в некотрую подписку
  - Реализации
   1) Cycle.js
   2) TSERS.js (?)
Примеры
1) сайд эффектфул имплементация
2)Cycle на евентмитторе
3)переход к стримам с игрушечными версиями - переход через сопоставляения с массивами и forEach vs map, filter
а) глупые драйверы - прямой порт с евент емиттера
б) умные идиоматичные драйверы 
4)реальные драйверы и цикл

Слайды
1)Пример фронтенд кода - sideeffects.js - стрелочки показывают на эффекты и их типы
2)В чем твоя проблема?
- не отражены в сигнатуре
 - сложно анализировать код - сайдэффекты не описываются в сигнатуре, не возвращаются из функции - их не видно в общем потоке программы. Если данные это некотрый поток - который можно   начать исследовать с конца или сначала и увидеть от чего зависит то или иное значение, то эффекты это точки которые не имеют источника или 
  Пример - если мы видим в интерфейсе некотрое неправильное значение мы можем пойти и посмотреть по коду откуда оно приходит постепенно разматываястек вызовов
  если мы видим в инспекторе лишний запрос то мы не знаем как его искать(обычно решается через сервисы)
 - плохая переиспользуемость
    обычные вычисления
    var lengthAndSum = calcLengthAndSum(list)
    var length = lengthAndSum.length
    с сайдэффектами
    var result = sendRequestAndWriteFile({ onlyRequest: true })
    пример с компонентом который шлет аналитику по клику на кнопку
 - нельзя типизировать (на самом деле можно https://medium.com/@gcanti/the-eff-monad-implemented-in-flow-40803670c3eb#.ezgaguogw)
- Зависимость от окружения
 - непредсказуемость - глядя на выполнения сайдэффекта в коде нельзя сказать чем он закончится - оборвется сеть, localStorage не сможет прочитатся - поэтому обычно всей сайд эффекты тупо заворачивают в try 
 - интерактивная разработка становится невозможной так как необходимо правильное окружение. нельзя в node repl запустить функцию которая обрабатывает хттп запросы или работает с домом. интерактивная разработка крайне важна так как позволяет находится в потоке. 
 - плохая тестируемость - чтобы протестировать функцию с сайд эффектами необходимы моки(окружение). Моки крайне обманчивы, очень трудно написать хороший мок - так как связи неявные
http://rea.tech/to-kill-a-mockingtest/ (обычно используется DI)

Самая главная проблема
Сайд эффекты заражают код(http://earth-chronicles.ru/Publications_6/19/chuma.jpg)
(воннегут) http://cultobzor.ru/wp-content/uploads/2013/09/0340.jpg
"Итак, в этом романе мир погибает, потому что во льду обнаружена молекула, которая превращает всю воду вокруг неё в лёд. Поскольку все воды мира связаны – ты понимаешь: от ручейка к озеру, потом реки, океаны. Весь мир застывает и погибает. И эту молекулу называют "Лёд 9". "
Двух цветный язык https://www.youtube.com/watch?v=OGSppLmGchY http://journal.stuffwithstuff.com/2015/02/01/what-color-is-your-function/
Два цвета - красный и синий
синий - чистые функции
красный - с сайдэффектами
как только мы заиспользовали внутри чистой функции функцию с сайд эффектом она стала не чистой
одна строчка кода изменяет свойства огромного количества кода

Окей а может так и надо? может быть мы просто ничего не можем поделать с этим и нужно просто смирится и учитиывать это. Давайте попробуем разобратся

2)А была ли логика? Какая была бизнесс логика в этом примере
  Пользователь кликает на кнопку -> делаем хттп запрос -> вставляем новую картинку - есть четкий пайплайн есть логика но нам мешает то каждая операция это сайдэффект
3)Давайте рассмотрим на примере одного эвента(передем от бесконечной последовательности к конечной)
Что мы имеем на входе?
Обьект Эвента 
```
{target: {tagName: 'BUTTON'}}
```
Отображается в запрос - представим запрос в виде обьект
```
{url: url}
```
Обьект ответа на запрос отображается в изменение дома
```
{
    selector: 'img', 
    op: 'setAttribute',
    args: ['src', 'SOME_URL']
}
```
Здесь картинка типа
DOM 
|
HTTP----HTTP
         |
        DOM
сплошные линии логика  штрих сайдэффекты
